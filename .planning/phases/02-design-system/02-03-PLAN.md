---
phase: 02-design-system
plan: 03
type: execute
wave: 2
depends_on:
  - "02-02"
files_modified:
  - src/components/animations/CustomCursor.tsx
  - src/app/[locale]/layout.tsx
autonomous: false
requirements:
  - DSGN-05

must_haves:
  truths:
    - "A custom cursor circle appears on desktop following the mouse with smooth interpolation"
    - "The cursor uses mix-blend-mode: difference for a subtle inversion effect across dark and light sections"
    - "The cursor scales up when hovering interactive elements (links, buttons)"
    - "The cursor is completely absent on touch devices — no stationary circle, no event listeners"
    - "The cursor disappears when the mouse leaves the viewport"
    - "The default system cursor is hidden on desktop when custom cursor is active"
  artifacts:
    - path: "src/components/animations/CustomCursor.tsx"
      provides: "Custom cursor component with mix-blend-mode"
      contains: "CustomCursor"
  key_links:
    - from: "src/components/animations/CustomCursor.tsx"
      to: "src/lib/gsap.ts"
      via: "gsap.quickTo for smooth position interpolation"
      pattern: "quickTo"
    - from: "src/components/animations/CustomCursor.tsx"
      to: "src/lib/device.ts"
      via: "isTouchDevice check to bail on touch devices"
      pattern: "isTouchDevice"
    - from: "src/app/[locale]/layout.tsx"
      to: "src/components/animations/CustomCursor.tsx"
      via: "CustomCursor rendered in layout for site-wide effect"
      pattern: "CustomCursor"
---

<objective>
Build the custom cursor component and wire it into the site layout.

Purpose: The custom cursor is a subtle, premium design element that reinforces the agency's attention to detail. It uses mix-blend-mode: difference for a refined visual effect that works across dark and light sections without color management. Desktop only — completely invisible on touch devices.

Output: CustomCursor.tsx component, updated layout.tsx
</objective>

<execution_context>
@/Users/mihaigrigore/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mihaigrigore/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-design-system/02-CONTEXT.md
@.planning/phases/02-design-system/02-RESEARCH.md
@.planning/phases/02-design-system/02-02-SUMMARY.md
@src/lib/gsap.ts
@src/lib/device.ts
@src/app/[locale]/layout.tsx
@src/styles/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CustomCursor component and wire into layout</name>
  <files>
    src/components/animations/CustomCursor.tsx
    src/app/[locale]/layout.tsx
  </files>
  <action>
**1. Create `src/components/animations/CustomCursor.tsx`:**

- 'use client' directive
- Per RESEARCH.md Pattern 3 and CONTEXT.md locked decisions:
- On mount, check if touch device using isTouchDevice() from @/lib/device. If touch → render null, don't attach any event listeners.
- Use gsap.quickTo for x and y position interpolation (duration: 0.2, ease: 'power3') — per RESEARCH.md, never use useState for cursor position (causes 60fps re-renders).
- Cursor element: fixed, pointer-events-none, z-[9999], 32px circle (w-8 h-8), rounded-full, bg-white, mix-blend-mode: difference, -translate-x-1/2 -translate-y-1/2
- Start with opacity: 0. Show (opacity: 1, duration: 0.3) on document mouseenter, hide on document mouseleave.
- Hover behavior on interactive elements per RESEARCH.md discretionary recommendation: scale from 32px to 64px on links and buttons. Use event delegation: listen for mouseover/mouseout on document, check if target (or closest ancestor) matches 'a, button, [role="button"], input[type="submit"]'. Scale up with gsap.to(cursorRef, { scale: 2, duration: 0.2 }), scale down on mouseout.
- Add 'custom-cursor-active' class to document.body on mount (desktop only) to trigger the CSS rule in globals.css that hides the default cursor. Remove on unmount.
- Wrap everything in gsap.matchMedia('(prefers-reduced-motion: no-preference)') — if user prefers reduced motion, show the default system cursor instead.
- Clean up all event listeners on unmount (useGSAP handles this via its cleanup return).

**2. Update `src/app/[locale]/layout.tsx`:**

- Import CustomCursor from @/components/animations/CustomCursor
- Add `<CustomCursor />` inside the body, after NextIntlClientProvider's children (so it renders above all content). Place it as the last child before closing body tag.
- CustomCursor is a client component with 'use client', so it's safe inside the server layout via automatic client boundary.

**Anti-patterns to avoid (from RESEARCH.md):**
- Do NOT use left/top CSS properties for positioning — use x/y transforms (GPU-composited)
- Do NOT forget pointer-events: none — cursor div must not intercept clicks
- Do NOT render the cursor div on touch devices — bail out entirely, not just hide
- Do NOT animate with useState — use refs + gsap.quickTo
  </action>
  <verify>
```bash
cd /Users/mihaigrigore/workspace/AceAgencyWebsite-V2- && npx tsc --noEmit 2>&1 | head -30
npm run build 2>&1 | tail -20
```
Verify TypeScript compiles and build succeeds. Verify CustomCursor is imported in layout.tsx.
  </verify>
  <done>
CustomCursor.tsx renders a mix-blend-mode: difference circle on desktop. It follows the mouse smoothly via gsap.quickTo. It scales up on interactive elements. It is invisible on touch devices. It disappears when mouse leaves viewport. The default cursor is hidden via body.custom-cursor-active class. It respects prefers-reduced-motion. Layout.tsx renders CustomCursor site-wide.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual verification of Header, Footer, MenuOverlay, and Custom Cursor</name>
  <files>
    src/components/layout/Header.tsx
    src/components/layout/MenuOverlay.tsx
    src/components/layout/Footer.tsx
    src/components/animations/CustomCursor.tsx
  </files>
  <action>
Human verification checkpoint. All Phase 2 layout components are built and wired into the site. The user visually and functionally verifies everything works.

Present the following verification steps to the user:
1. Run `npm run dev` and visit http://localhost:3000/ro/
2. **Header:** Verify logo placeholder, hamburger button, and CTA ("Contacteaza-ne") are visible. Scroll down — header should hide smoothly. Scroll up — header should reappear. Check glass morphism backdrop blur appears when scrolled.
3. **Menu Overlay:** Click the hamburger. Verify fullscreen overlay slides in. Verify nav link text animates in with character-by-character stagger (SplitText effect). Click a nav link — overlay should close and navigate. Verify locale switcher (RO/EN) is inside the overlay and works.
4. **Footer:** Scroll to the bottom. Verify logo, tagline, division badges (AceWeb, AceAds, AceAI, AceMedia), office info, social icons (LinkedIn, Instagram, Facebook), quick nav links, newsletter form, copyright, and legal links are all visible. Verify scroll-reveal animation plays as footer enters viewport.
5. **Custom Cursor:** On desktop, verify a white circle follows the mouse with mix-blend-mode effect. Hover over links/buttons — cursor should grow. Move mouse off the browser window — cursor should disappear. If on a touch device or with prefers-reduced-motion, verify the custom cursor is absent and the default cursor works normally.
6. **Responsive:** Resize to mobile width (375px). Verify header layout adapts, hamburger is prominent, footer stacks vertically, and tap targets are at least 48x48px.
7. Switch to English: navigate to /en/ and verify all text is translated.

Resume signal: Type "approved" if all layout components work correctly, or describe specific visual/functional issues.
  </action>
  <verify>User confirms all layout components render and function correctly.</verify>
  <done>User has approved the visual and functional verification of Header, Footer, MenuOverlay, CustomCursor, and TextReveal. Phase 2 is complete.</done>
</task>

</tasks>

<verification>
- `npm run build` completes with zero errors
- CustomCursor renders on desktop, absent on touch devices
- mix-blend-mode: difference effect visible across dark and light sections
- Cursor hover scale-up works on links and buttons
- Body has cursor: none on desktop when custom cursor active
- CustomCursor respects prefers-reduced-motion
- All Phase 2 components (Header, Footer, MenuOverlay, TextReveal, CustomCursor) are functional
</verification>

<success_criteria>
The custom cursor provides a subtle, premium visual effect on desktop without impacting interactivity. It works seamlessly across dark and light page sections via mix-blend-mode. Touch device users see the standard cursor with no visual artifacts. The complete Phase 2 layout is verified: Header with overlay menu, Footer with full content, CustomCursor site-wide, TextReveal available for headings.
</success_criteria>

<output>
After completion, create `.planning/phases/02-design-system/02-03-SUMMARY.md`
</output>
